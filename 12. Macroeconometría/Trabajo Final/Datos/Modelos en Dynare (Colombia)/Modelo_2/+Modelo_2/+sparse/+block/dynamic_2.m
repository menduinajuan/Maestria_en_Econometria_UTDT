function [y, T, residual, g1] = dynamic_2(y, x, params, steady_state, sparse_rowval, sparse_colval, sparse_colptr, T)
residual=NaN(7, 1);
  y(26)=y(25)+params(7);
  T(1)=exp(y(9)-params(10));
  residual(1)=(y(25))-(params(11)*(T(1)-1));
  residual(2)=(y(16))-(y(17)+y(3)*(1-params(2)));
  T(2)=params(5)/2*(y(16)-y(3))^2;
  residual(3)=(y(15)+y(17)+T(2)+(1+y(26))*y(9))-(y(14)+y(22));
  T(3)=y(15)-y(18)^params(4)/params(4);
  T(4)=T(3)^(-params(3));
  T(5)=y(28)-y(31)^params(4)/params(4);
  T(6)=params(9)*T(5)^(-params(3));
  residual(4)=(T(4))-(T(6)*(1+params(1)*y(27)/y(16)-params(2)+params(5)*(y(29)-y(16)))/(1+params(5)*(y(16)-y(3))));
  residual(5)=(T(4))-(T(6)*(1+y(26)));
  T(7)=y(19)*y(3)^params(1);
  T(8)=y(18)^(1-params(1));
  residual(6)=(y(14))-(T(7)*T(8));
  residual(7)=(y(18)^(params(4)-1))-((1-params(1))*y(14)/y(18));
  T(9)=getPowerDeriv(T(3),(-params(3)),1);
  T(10)=getPowerDeriv(T(5),(-params(3)),1);
  T(11)=T(9)*(-(getPowerDeriv(y(18),params(4),1)/params(4)));
  T(12)=params(9)*T(10)*(-(getPowerDeriv(y(31),params(4),1)/params(4)));
if nargout > 3
    g1_v = NaN(31, 1);
g1_v(1)=(-(params(11)*T(1)));
g1_v(2)=1+y(26);
g1_v(3)=(-(1-params(2)));
g1_v(4)=params(5)/2*(-(2*(y(16)-y(3))));
g1_v(5)=(-((-(T(6)*(1+params(1)*y(27)/y(16)-params(2)+params(5)*(y(29)-y(16)))*(-params(5))))/((1+params(5)*(y(16)-y(3)))*(1+params(5)*(y(16)-y(3))))));
g1_v(6)=(-(T(8)*y(19)*getPowerDeriv(y(3),params(1),1)));
g1_v(7)=1;
g1_v(8)=y(9);
g1_v(9)=(-T(6));
g1_v(10)=(-1);
g1_v(11)=1;
g1_v(12)=(-1);
g1_v(13)=1;
g1_v(14)=params(5)/2*2*(y(16)-y(3));
g1_v(15)=(-(((1+params(5)*(y(16)-y(3)))*T(6)*(params(1)*(-y(27))/(y(16)*y(16))-params(5))-params(5)*T(6)*(1+params(1)*y(27)/y(16)-params(2)+params(5)*(y(29)-y(16))))/((1+params(5)*(y(16)-y(3)))*(1+params(5)*(y(16)-y(3))))));
g1_v(16)=1;
g1_v(17)=T(9);
g1_v(18)=T(9);
g1_v(19)=(-1);
g1_v(20)=1;
g1_v(21)=(-((1-params(1))*1/y(18)));
g1_v(22)=T(11);
g1_v(23)=T(11);
g1_v(24)=(-(T(7)*getPowerDeriv(y(18),1-params(1),1)));
g1_v(25)=getPowerDeriv(y(18),params(4)-1,1)-(1-params(1))*(-y(14))/(y(18)*y(18));
g1_v(26)=(-(T(6)*params(5)/(1+params(5)*(y(16)-y(3)))));
g1_v(27)=(-((1+params(1)*y(27)/y(16)-params(2)+params(5)*(y(29)-y(16)))*params(9)*T(10)/(1+params(5)*(y(16)-y(3)))));
g1_v(28)=(-((1+y(26))*params(9)*T(10)));
g1_v(29)=(-(T(6)*params(1)*1/y(16)/(1+params(5)*(y(16)-y(3)))));
g1_v(30)=(-((1+params(1)*y(27)/y(16)-params(2)+params(5)*(y(29)-y(16)))*T(12)/(1+params(5)*(y(16)-y(3)))));
g1_v(31)=(-((1+y(26))*T(12)));
    if ~isoctave && matlab_ver_less_than('9.8')
        sparse_rowval = double(sparse_rowval);
        sparse_colval = double(sparse_colval);
    end
    g1 = sparse(sparse_rowval, sparse_colval, g1_v, 7, 21);
end
end
